name: Publish Website

on:
  push:
    branches:
      - main

jobs:
  web-deploy:
    name: ðŸš€ Deploy Website Every Commit
    runs-on: ubuntu-latest
    steps:
      - name: ðŸšš Get Latest Code
        uses: actions/checkout@v3

      - name: ðŸ“¦ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"
          cache: "npm"

      - name: ðŸ“¥ Install Dependencies
        run: npm ci

      - name: ðŸ”¨ Build Assets
        run: npm run build

      - name: ðŸ“‹ List dist folder
        run: ls -la dist/

      - name: ðŸ“‚ Sync Files
        uses: SamKirkland/web-deploy@v1
        with:
          target-server: ballstreetsportsjournal.com
          remote-user: ballstreetsportsjournalcom
          private-ssh-key: ${{ secrets.SSH_KEY }}
          destination-path: /home/ballstreetsportsjournalcom/public_html/wp-content/themes/wordwind

          ssh-port: 6543
          rsync-options: --archive --verbose --compress --delete --exclude=node_modules --exclude=.git --exclude=.github --exclude=src
